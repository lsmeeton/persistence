'''
Created on 16 Dec 2013

@author: lewis
'''
import unittest
from persistencediagram.datareadgmin import DataReadGMIN

class Test(unittest.TestCase):


    def setUp(self):
        self.dr = DataReadGMIN('min.data','ts.data')
        self.testdr = DataReadGMIN('min.data','ts.data')
        self.testdr.m = [14.4488253121,
                     16.5485808188,
                     14.0832411640,
                     25.9694100639,
                     12.7849943904,
                     15.6078629731,
                     24.3032893806,
                     17.0312100913,
                     27.1543628436,
                     20.8040102383,
                     16.8234533248,
                     24.9586312251,
                     16.4142907432,
                     17.9948602565,
                     24.9443684808,
                     17.5308384694,
                     15.0882532420,
                     15.1099343729,
                     19.0802277948,
                     22.1460042168,
                     23.7682178832,
                     24.7622883583,
                     21.1946479837,
                     15.1873243882,
                     19.2291921628,
                     18.6880422281,
                     15.1076737289,
                     22.8715471004,
                     17.3729098656,
                     17.1079272452,
                     24.2736453661,
                     23.6314369034,
                     24.2979250952,
                     22.6289825902,
                     29.7100216648,
                     31.9232281981,
                     24.0752342021,
                     31.8342271560,
                     23.9909754366,
                     30.8424524699,
                     27.2911194406,
                     40.3217504213,
                     23.7026915426,
                     29.4751773911,
                     22.5308550709,
                     17.5305267805,
                     31.1257670851,
                     17.0360289807,
                     30.7546372357,
                     32.8049393629,
                     27.4374591770,
                     33.2378235449,
                     29.1945269610,
                     31.3270337239,
                     36.9132625724]
        
        self.testdr.ts = [(31.1436628266,   7,  47), 
                          (40.7106147176,   9,  34),
                          (40.7356128403,   7,  32),
                          (29.9886340652,  33,  35),
                          (22.8932943363,   6,  27),
                          (35.7553048367,  27,  16),
                          (44.5066662376,  54,  33),
                          (29.2091826543,  33,  34),
                          (32.6429494501,   1,  17),
                          (38.0093576869,  23,   7),
                          (25.2131968484,  33,  10),
                          (22.4849672993,  23,  10),
                          (46.0541450870,  53,  39),
                          (37.5290370280,  13,  48),
                          (37.4700211605,  46,  22),
                          (42.1937697919,  46,  44),
                          (24.7240962100,  46,  29),
                          (23.2886960969,  13,  17),
                          (48.6821174374,  55,  50),
                          (44.9948594891,  50,  38),
                          (18.3911584054,   1,   3),
                          (30.9993288207,   6,   1),
                          (25.9652255550,   6,  13),
                          (18.2933818514,  14,  13),
                          (18.6159343448,  18,   1),
                          (58.2830620095,   5,   1),
                          (12.8449850419,   5,   5),
                          (32.3597516801,  25,  11),
                          (17.0363622680,  17,  11),
                          (34.0545567122,  11,   3),
                          (39.9267851771,  44,  31),
                          (35.2707625075,  44,  45),
                          (38.6933020629,  31,  24),
                          (44.5421442324,   7,   4),
                          (38.1730323936,  36,   7),
                          (30.1676529326,  11,   1),
                          (46.3009308258,  51,  28),
                          (34.6304676781,  28,  39),
                          (49.2184396743,  33,  41),
                          (30.5997422986,   1,   6),
                          (31.9835172903,  36,  38),
                          (31.6956555133,  34,  40),
                          (29.4794608793,  27,   3),
                          (29.7453583418,  25,  35),
                          (39.8072906388,  37,  25),
                          (30.8001925899,   6,   5),
                          (16.7026348195,   6,   2),
                          (35.2794481233,  46,   6),
                          (28.2478840163,  22,   9),
                          (39.8398986502,  19,  22),
                          (23.7795659529,  19,  34),
                          (29.1382189366,  24,   1),
                          (16.1110778608,  24,  27),
                          (36.2323980686,  20,   7),
                          (44.3819230871,   7,   4),
                          (34.5999073453,  26,  13),
                          (26.5675431597,  34,  32),
                          (34.5144246306,  39,  47),
                          (40.5559367342,  39,  42),
                          (23.0824758845,  20,  23),
                          (43.3552890317,  53,   7),
                          (37.6737471415,  43,  29),
                          (36.6768798538,  28,  29),
                          (33.0431850820,  17,  29),
                          (30.7853552625,  51,  51),
                          (42.3631604074,  51,  22),
                          (33.3818679295,  52,  51),
                          (35.0753803548,   6,  19),
                          (33.1979615358,  19,   6),
                          (22.3835239900,  19,  10),
                          (31.8737913026,  17,   3),
                          (31.7204500406,  30,  16),
                          (33.7345716142,  11,  30),
                          (35.5592576358,  30,  11),
                          (29.1243527870,   9,   7),
                          (33.6603798337,  24,   8),
                          (33.1014488645,  18,  24),
                          (40.6479833399,  39,  29),
                          (38.2554232518,   8,   7),
                          (39.8857078192,   8,   7),
                          (24.4630052378,  16,   8),
                          (62.3419293415,  42,   9),
                          (38.3029643723,  21,  19),
                          (29.4168532804,  48,  29),
                          (35.0266581744,  13,  18),
                          (28.7769880342,  31,  33),
                          (32.8110039358,  12,  13),
                          (46.7352595146,  39,  50),
                          (44.2278503087,  37,  50),
                          (37.5962197349,  20,   6),
                          (36.2408662203,   6,  32),
                          (38.1751255290,   8,   7),
                          (30.4721209433,   1,  17),
                          (34.7596925566,  19,  17),
                          (37.5743880464,  12,  17),
                          (24.9706689382,  12,  15),
                          (45.0988592884,  45,  53),
                          (30.5116983730,   7,  45),
                          (39.6413884473,  53,  49),
                          (33.9981727619,  50,  49),
                          (42.0824428608,  21,  29),
                          (34.7667362741,  54,  44),
                          (31.3616643255,  22,  54),
                          (32.0661144507,  14,  26),
                          (30.9789331836,  26,  40),
                          (29.1976556712,   1,  24),
                          (33.7375198144,  24,  32),
                          (30.0420891807,  32,  26),
                          (31.5003608153,  46,  27),
                          (44.3218084779,   7,  49),
                          (37.4311058464,  22,  37),
                          (25.6840784492,  21,  22),
                          (33.5185097286,  10,  24),
                          (37.6509898517,   2,  23),
                          (43.4079788638,  34,  47),
                          (33.3505718066,   2,   1),
                          (48.4984279234,  37,  53),
                          (38.4442212966,   4,  37),
                          (35.9135794095,  45,  26),
                          (43.3043600248,  53,  45),
                          (43.0770682646,  53,   7),
                          (36.6365480971,  43,  45),
                          (43.1900079134,  45,  12),
                          (38.5021146329,  12,  37),
                          (42.8014910705,  15,  45),
                          (32.2901487344,  15,   4),
                          (45.4915647045,  53,   7),
                          (38.6845017793,  37,   4),
                          (34.9017249010,  38,  37),
                          (32.0863256828,   2,  19),
                          (35.7468043828,   6,  19),
                          (30.0611264869,  28,  22),
                          (32.1875044024,  27,   1),
                          (40.4264486303,  21,  20),
                          (22.9591659909,  20,  19),
                          (31.6676593020,  29,  24),
                          (36.6651272621,  13,  31),
                          (37.5312243447,  14,  26),
                          (29.2586072787,   5,  14),
                          (16.5393012580,   1,   5),
                          (37.4373804627,  45,  44),
                          (37.3510471936,  22,  10),
                          (46.8285423797,  41,  40),
                          (37.6694872922,  26,  21),
                          (37.2134800052,  10,  22),
                          (52.7474808984,   1,   3),
                          (54.7059708697,   1,  18),
                          (30.4531890741,   2,  18),
                          (30.7131134783,  31,  25),
                          (23.5781170087,  24,   2),
                          (30.7680140638,  14,  30),
                          (59.1483279371,  11,   2),
                          (30.0288968650,  48,  17),
                          (30.1516069805,  24,  17),
                          (35.6706103810,  24,  26),
                          (43.8785822332,  40,  33),
                          (29.1559835231,  45,  41),
                          (26.1080347126,  13,   2),
                          (34.6080164740,  31,  23),
                          (37.4190868572,  11,  10),
                          (29.7016567507,  18,  17),
                          (33.7387757613,  17,  25),
                          (27.9822697108,  13,  27),
                          (39.8644429362,   7,   8),
                          (33.8121691288,  29,   8),
                          (40.4514592636,  28,  10),
                          (39.9210289316,  29,  22),
                          (45.6403151025,  43,  51),
                          (41.3801572241,  28,  51),
                          (24.8261102943,  43,  28),
                          (24.5581562304,  30,  29),
                          (37.1752008087,  14,  26),
                          (35.8728472703,  27,  25),
                          (41.5540142952,  42,  44),
                          (46.7341787888,  32,  44),
                          (37.4060378955,  32,  39),
                          (41.4065025093,  39,  31),
                          (43.6295119416,   7,   4),
                          (62.1007016708,  24,  14),
                          (28.6289910065,   1,  13),
                          (36.0813086885,  28,  26),
                          (41.1682954605,  43,  23),
                          (29.7214603122,  16,   6),
                          (33.9356001726,  31,  27),
                          (38.9681285842,  44,  31),
                          (35.9972302411,  28,   7),
                          (28.2301037726,  28,  41),
                          (20.6947497061,  25,  26),
                          (37.7581926709,  45,  26),
                          (61.9202492856,  22,   9),
                          (36.3071583973,  21,   7),
                          (60.8233425157,  22,  47),
                          (38.8513464807,  39,  26),
                          (35.2843095955,  19,  17),
                          (34.7982200754,  17,  24),
                          (41.4079212572,   4,  11),
                          (25.8203243989,  11,  14),
                          (39.2471140290,  32,   2),
                          (33.0143632766,  15,  19),
                          (32.4460608979,  37,  45),
                          (35.1131259299,  35,   4),
                          (49.3427825401,  44,  55),
                          (40.7233661467,  44,  38),
                          (35.6277907818,   2,   4),
                          (40.0471055438,  26,  28),
                          (42.2520781973,  34,  35),
                          (27.7815349050,   2,  11),
                          (39.8986165977,  12,  17),
                          (44.1877789801,  22,  50),
                          (36.2931469525,  23,  27),
                          (45.6859158721,  47,  53),
                          (46.3981041585,  53,  50),
                          (49.3155113620,  28,  54),
                          (38.1208899610,  53,  49),
                          (50.3772283684,  45,  47),
                          (17.6419506053,   1,  18),
                          (40.5936448350,  32,  36),
                          (45.5944181553,  26,  37),
                          (33.6297306069,  39,   7),
                          (40.8168903571,  33,  42),
                          (35.0546720118,  14,   1),
                          (45.7204802604,  45,  49),
                          (33.4176065089,  19,  25),
                          (38.6704023594,   6,  29),
                          (42.8553297419,  49,  53),
                          (34.2569213546,  52,  49),
                          (41.2101355261,  45,  44),
                          (46.4824203802,  49,  44),
                          (31.8818169478,   4,  10),
                          (32.0918882402,  29,  24),
                          (34.5559854401,  10,  27),
                          (32.4234926516,  18,  24),
                          (37.2425254034,  10,  11),
                          (47.5269493609,  35,   9),
                          (36.5923130843,  16,  45),
                          (30.4035271926,  17,  24),
                          (41.3958868495,   6,  40),
                          (41.4477742645,  11,   4),
                          (36.4219637824,  28,  26),
                          (41.9965000956,  42,  41),
                          (37.5640324868,  10,   2),
                          (38.4568148801,  19,  37),
                          (38.4164883207,  48,  45),
                          (28.0709168214,  31,  32),
                          (29.5139159189,  18,   2),
                          (38.4316117193,  31,  24),
                          (37.9133366494,  13,  25),
                          (41.7748318394,  44,  29),
                          (31.3724807160,  26,  32),
                          (31.3291874587,  13,  29),
                          (37.3163573050,  15,  40),
                          (37.6610174672,  43,  25),
                          (49.3073085195,  53,  39),
                          (38.9727104824,  44,  39),
                          (26.4287832224,  14,  24),
                          (38.3590617821,  39,  10),
                          (38.4454304048,  16,   7),
                          (46.7112313856,  50,  51),
                          (37.9538427539,  10,  39),
                          (38.9207434147,  39,  26),
                          (33.7192642948,   1,   2),
                          (30.4577353750,   2,   8),
                          (47.0868634137,  35,   9),
                          (35.5248226892,  14,  16),
                          (50.7407626686,  36,  49),
                          (42.4044338142,  22,  51),
                          (38.0117739287,   4,  17),
                          (55.9177443819,  18,   1),
                          (38.0957245116,  21,  10),
                          (30.9161507076,  16,  11),
                          (37.1990515113,  28,  25),
                          (41.0305226798,  51,  28),
                          (38.0399467299,  21,  26),
                          (58.8311386294,  27,  24),
                          (26.7922111445,  16,  48),
                          (43.3732939246,  39,  49),
                          (36.1456858190,  45,  16),
                          (30.6498475200,  21,  43),
                          (33.2546749394,  10,  26),
                          (47.7504533162,   5,   6),
                          (48.3223857247,  28,  50),
                          (39.5275734019,  30,  28),
                          (35.6534586165,   8,  24),
                          (42.6718674672,  43,  49),
                          (39.9691438763,  37,  12),
                          (34.2302806640,  24,  23),
                          (44.2642490723,  50,  53),
                          (48.9886478187,  41,  52),
                          (38.5076358895,  19,  21),
                          (45.7384976168,  45,  37),
                          (47.7167377436,  37,  49),
                          (39.8456440375,  48,  37),
                          (33.2549387071,  39,  37),
                          (37.3232615341,  26,  43),
                          (29.5470287019,  26,  12),
                          (39.1518545912,  28,  30),
                          (39.6229302018,  50,  53),
                          (35.6554121269,  16,  14),
                          (44.1869794654,  39,  49),
                          (33.7020653638,  27,   1),
                          (32.4933071625,  16,  46),
                          (42.9630441351,  29,   8),
                          (40.9619523111,  32,  20),
                          (39.1316337088,  45,  48),
                          (43.3174835537,  29,  36),
                          (42.4859174966,  24,  24),
                          (35.1771012019,   4,  26),
                          (40.7021324919,   6,  19),
                          (53.9376236634,  41,  29),
                          (46.3256947713,  44,  49),
                          (44.8674676268,  53,  49),
                          (50.6302794825,  44,  22),
                          (51.5056133885,  28,  38),
                          (50.8710121829,  28,  38),
                          (44.4637408805,  21,  49),
                          (40.6966594380,  21,  20),
                          (64.7813720422,  24,   2),
                          (41.0594115405,  12,  31),
                          (39.8546440974,  32,   4),
                          (43.7631281733,  31,  39),
                          (38.6484954603,   2,  23),
                          (38.8959533035,  15,  31),
                          (44.6777917724,  12,  44),
                          (47.1178238615,  40,  41),
                          (34.5533332773,  26,  20),
                          (36.8795185861,  17,  26),
                          (48.5457113462,  14,  36),
                          (40.7941395774,  29,  22),
                          (30.6361690377,  24,   1),
                          (40.7827229836,   9,  41),
                          (62.4424371058,  54,   7),
                          (48.8448540671,  28,  32),
                          (37.7205550534,  39,  44),
                          (43.2367827134,   8,  39),
                          (42.3703125935,  16,  39),
                          (26.0224692580,  17,   6),
                          (34.4217897134,  24,  18),
                          (41.6717659659,  31,  24),
                          (41.7011748233,  35,   2),
                          (40.0856040406,  29,   2),
                          (42.7625075126,  24,  27),
                          (60.7867162828,   6,   2),
                          (46.9658872907,   4,  36)]




    def tearDown(self):
        pass

    def testFileNames(self):
        self.assertEqual(self.dr.min_file,   self.testdr.min_file, 'File names inexplicably different')
        self.assertEqual(self.dr.ts_file,   self.testdr.ts_file, 'File names inexplicably different')
        
    def testReadMinima(self):
        self.dr.ReadMinima()
        self.assertEqual(self.testdr.m, self.dr.m , "Minima have not been read from file correctly")

    def testReadTransitionStates(self):
        self.dr.ReadTransitionStates()
        self.assertEqual(self.testdr.ts, self.dr.ts , "Transition States have not been read from file correctly")

if __name__ == "__main__":
    #import sys;sys.argv = ['', 'Test.testName']
    unittest.main()
